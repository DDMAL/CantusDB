{% extends "base.html" %}
{% block content %}
<title>{{ chant.incipit }} | Cantus Manuscript Database</title>
<div class="container">
    <div class="row">
        <div class="mr-3 p-3 col-lg-8 bg-white rounded">
            <h3>{{ chant.incipit }}</h3>
            <dl>
                <div class="row">
                    <div class="col">
                        <dt>
                            Source
                        </dt>
                        <dd>
                            <a href="{{ chant.source.get_absolute_url }}">
                                {{ chant.source.title }}
                            </a>
                        </dd>
                    </div>
                    {% if chant.marginalia %}
                    <div class="col">
                        <dt>
                            Marginalia
                        </dt>
                        <dd>
                            {{ chant.marginalia }}
                        </dd>
                    </div>
                    {% endif %}
                </div>

                <div class="row">
                    {% if chant.folio %}
                    <div class="col">
                        <dt>
                            Folio
                        </dt>
                        <dd>
                            {{ chant.folio }}
                        </dd>
                    </div>
                    {% endif %}
                    <div class="col">
                        {% comment %} {% if chant.sequence_number %} {% endcomment %}
                        <dt>
                            Sequence
                        </dt>
                        <dd>
                            {{ chant.sequence_number }}
                        </dd>
                        {% comment %} {% endif %} {% endcomment %}
                    </div>
                </div>
                
                <div class="row">
                    {% if chant.feast %}
                    <div class="col">
                        <dt>
                            Feast
                        </dt>
                        <dd>
                            <a href="{{ chant.feast.get_absolute_url }}">{{ chant.feast.name }}</a>
                        </dd>
                    </div>
                    {% endif %}
                    {% if chant.office %}
                    <div class="col">
                        <dt>
                            Office/Mass
                        </dt>
                        <dd>
                            <a href="{{ chant.office.get_absolute_url }}">{{ chant.office.name }}</a>
                        </dd>
                    </div>
                    {% endif %}
                    {% if chant.genre %}
                    <div class="col">
                        <dt>
                            Genre
                        </dt>
                        <dd>
                            <a href="{{ chant.genre.get_absolute_url }}">{{ chant.genre.name }}</a>
                        </dd>
                    </div>
                    {% endif %}
                    {% if chant.position %}
                    <div class="col">
                        <dt>
                            Position
                        </dt>
                        <dd>
                            {{ chant.position }}
                        </dd>
                    </div>
                    {% endif %}
                    {% if chant.cantus_id %}
                    <div class="col">
                        <dt>
                            Cantus ID
                        </dt>
                        <dd>
                            {{ chant.cantus_id }}
                        </dd>
                    </div>
                    {% endif %}
                    {% if chant.mode %}
                    <div class="col">
                        <dt>
                            Mode
                        </dt>
                        <dd>
                            {{ chant.mode }}
                        </dd>
                    </div>
                    {% endif %}
                </div>

                <div class="row">
                    {% if chant.finalis %}
                    <div class="col">
                        <dt>
                            Finalis
                        </dt>
                        <dd>
                            {{ chant.finalis }}
                        </dd>
                    </div>
                    {% endif %}
                    {% if chant.differentia %}
                    <div class="col">
                        <dt>
                            Differentia
                        </dt>
                        <dd>
                            {{ chant.differentia }}
                        </dd>
                    </div>
                    {% endif %}
                    {% if chant.addendum %}
                    <div class="col">
                        <dt>
                            Addendum
                        </dt>
                        <dd>
                            {{ chant.addendum }}
                        </dd>
                    </div>
                    {% endif %}
                    {% if chant.extra %}
                    <div class="col">
                        <dt>
                            Extra
                        </dt>
                        <dd>
                            {{ chant.extra }}
                        </dd>
                    </div>
                    {% endif %}
                </div>

                {% if chant.manuscript_full_text_std_spelling %}
                <dt>
                    Manuscript Reading Full Text (standardized spelling)
                </dt>
                <dd>
                    {{ chant.manuscript_full_text_std_spelling }}
                </dd>
                {% endif %}
                {% if chant.manuscript_full_text %}
                <dt>
                    Manuscript Reading Full Text (MS spelling)
                </dt>
                <dd>
                    {{ chant.manuscript_full_text }}
                </dd>
                {% endif %}
                {% if chant.chant_range %}
                <dt>
                    Range
                </dt>
                <dd>
                    <p style="font-family: volpiano; font-size:30px">
                        {{ chant.chant_range }}
                    </p>
                </dd>
                {% endif %}
                {% if chant.volpiano %}
                <dt>
                    Volpiano
                </dt>
                <dd>
                    <p style="font-family: volpiano; font-size:30px">
                        {{ chant.volpiano }}
                    </p>
                </dd>
                {% endif %}
                {% if chant.indexing_notes %}
                <dt>
                    Indexing Notes
                </dt>
                <dd>
                    {{ chant.indexing_notes }}
                </dd>
                {% endif %}
                {% if chant.volpiano and chant.manuscript_full_text %}
                <dt>
                    Melody with text
                </dt>
                <!-- TODO: figure out how to silabilize the text and align with melody -->
                <dd>
                    <p style="font-family: volpiano; font-size:30px">
                        {{ chant.volpiano }}
                    </p>
                    <p>
                        {{ chant.manuscript_syllabized_full_text }}
                    </p>
                </dd>
                {% endif %}

                {% if chant.image_link %}
                <dt>
                    Image link
                </dt>
                <dd>
                    <a href="{{ chant.image_link }}" target="_blank">{{ chant.image_link }}</a>
                </dd>
                {% endif %}
            </dl>

            

            <a href="" class="btn btn-primary" id="delete">Delete this Chant</a>
            <script>
                window.onload = function () {
                    document.getElementById("delete").href = window.location.href + '/delete';
                }
            </script>

        </div>

        <div class="col">
            <div class="row">
                {% with source=chant.source %}
                <div class="card mb-3 w-100">
                    <div class="card-header">
                        <!-- TODO: add proper segment link here -->
                        <small><a href="#">
                                {{ source.segment.name }}</a></small>
                        <br>
                        {{ source.siglum }}
                    </div>
                    <div class="card-body">
                        <!-- TODO: add proper links here -->
                        <small>
                            <b>Provenance:</b> <a href="#">{{source.provenance.name}}</a>
                            <br>
                            {% if source.date %}
                            <b>Date: </b><a href="#">{{source.century.all.first.name }}</a> |
                            <b>{{source.date|default_if_none:""}}</b>
                            <br>
                            {% endif %}
                            {% if source.cursus %}
                            <b>Cursus: </b><b>{{source.cursus|default_if_none:""}}</b>
                            <br>
                            {% endif %}
                            {% if source.notation.all %}
                            <b>Notation: </b><a href="#">{{source.notation.all.first.name}}</a>
                            <br>
                            {% endif %}
                            {% if source.inventoried_by.all %}
                            <b>Inventoried by:</b>
                            <ul class="list-unstyled" style="margin-bottom: 0rem;">
                                {% for editor in source.inventoried_by.all %}
                                <li>
                                    <a href={{ editor.get_absolute_url }}>{{editor.first_name}}
                                        {{editor.family_name}}</a><br>
                                    {{ editor.institution|default_if_none:"" }}
                                </li>
                                {% endfor %}
                            </ul>
                            {% endif %}
                            <b>Proofreader{{source.proofreaders.all|pluralize}}:</b><br>
                            {% if source.proofreaders.all %}
                            <ul class="list-unstyled" style="margin-bottom: 0rem;">
                                {% for editor in source.proofreaders.all %}
                                <li>
                                    <a href={{ editor.get_absolute_url }}>{{editor.first_name}}
                                        {{editor.family_name}}</a>
                                </li>
                                {% endfor %}
                            </ul>
                            {% endif %}
                            {{source.indexing_notes|default_if_none:""}}
                            {% comment %} <br>
                            Contributor: {% endcomment %}
                        </small>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endwith %}
{% endblock %}